name: 'Conditional Composite'
description: 'Test composite run step conditionals'
inputs:
  exit-code:
    description: 'Action fails if set to non-zero'
    default: '0'
  child-exit-code:
    description: 'Nested Action fails if set to non-zero'
    default: '0'

outputs:
  success:
    description: "Did step run with default?"
    value: ${{ steps.success.outputs.success }}
  failure:
    description: "Did step run with default?"
    value: ${{ steps.failure.outputs.failure }}


runs:
    using: "composite"
    steps:
      - run: echo ${{ github.action_status }}
        name: Print gh status
        shell: bash

      - run: echo ${{ inputs.exit-code }}
        shell: bash

      - uses: ./action-status
        with:
          exit-code: ${{ inputs.child-exit-code }}

      - run: echo ${{ github.action_status }}
        shell: bash

      - run: echo "::set-output name=failure::true"
        id: failure
        if: failure()
        shell: bash

      - run: echo "::set-output name=success::true"
        id: success
        if: success()
        shell: bash